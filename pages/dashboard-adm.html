<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ACQUASHOW - Dashboard ADM</title>
  <style>
    body {
      font-family: system-ui, Arial, sans-serif;
      margin: 0;
      padding: 16px;
      background: #f3f7fb;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }

    h1 {
      margin: 0;
      font-size: 1.6rem;
    }

    .user-info {
      font-size: 0.9rem;
      color: #555;
    }

    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.06);
      margin-bottom: 20px;
    }

    .card h2 {
      margin-top: 0;
      font-size: 1.2rem;
    }

    label {
      display: block;
      font-size: 0.9rem;
      margin-top: 8px;
      margin-bottom: 4px;
    }

    input, select, textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 6px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }

    button {
      padding: 10px 16px;
      border-radius: 8px;
      border: none;
      background: #00a5e9;
      color: #fff;
      font-weight: 600;
      cursor: pointer;
      margin-right: 8px;
    }

    button:hover {
      opacity: 0.9;
    }

    .piscinas-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .piscinas-list li {
      padding: 8px 0;
      border-bottom: 1px solid #eee;
      font-size: 0.95rem;
    }

    .muted {
      color: #777;
      font-size: 0.85rem;
    }

    .badge {
      background: red;
      color: #fff;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.8rem;
      margin-left: 4px;
    }
  </style>
</head>
<body>
  <header>
    <h1>ACQUASHOW - Dashboard ADM</h1>
    <div class="user-info">
      Logado como: <span id="infoNome">Carregando...</span> |
      Papel: <span id="infoPapel">ADM</span>
    </div>
  </header>

  <main>

    <!-- CARD 1: CADASTRAR NOVO USU츼RIO -->
    <section class="card">
      <h2>Cadastrar novo usu치rio (funcion치rio / cliente)</h2>

      <form id="formCadastroUsuario">
        <div class="form-group">
          <label for="nomeUsuario">Nome completo</label>
          <input id="nomeUsuario" type="text" />
        </div>

        <div class="form-group">
          <label for="emailUsuario">E-mail</label>
          <input id="emailUsuario" type="email" />
        </div>

        <div class="form-group">
          <label for="telefoneUsuario">Telefone (WhatsApp)</label>
          <input id="telefoneUsuario" type="text" />
        </div>

        <div class="form-group">
          <label for="senhaUsuario">Senha inicial</label>
          <input id="senhaUsuario" type="password" />
        </div>

        <div class="form-group">
          <label for="roleUsuario">N칤vel de acesso</label>
          <select id="roleUsuario">
            <option value="">Selecione...</option>
            <option value="ADM">Administrador</option>
            <option value="FUNCIONARIO">Funcion치rio</option>
            <option value="CLIENTE">Cliente</option>
          </select>
        </div>

        <button type="submit">Criar usu치rio</button>
      </form>
    </section>

    <!-- CARD 2: CADASTRAR / EDITAR PISCINA (FORM PRINCIPAL) -->
    <section class="card">
      <h2>Cadastrar nova piscina</h2>

      <form id="formPiscina">
        <!-- Cliente -->
        <div class="form-group">
          <label for="clientePiscina">Cliente</label>
          <select id="clientePiscina">
            <option value="">Selecione o cliente...</option>
          </select>
          <small class="muted">Os clientes cadastrados ir칚o aparecer aqui.</small>
        </div>

        <!-- Respons치vel (funcion치rio) -->
        <div class="form-group">
          <label for="responsavelPiscina">Respons치vel (funcion치rio)</label>
          <select id="responsavelPiscina">
            <option value="">Selecione...</option>
          </select>
          <small class="muted">Os funcion치rios cadastrados ir칚o aparecer aqui.</small>
        </div>

        <!-- Apelido / nome da piscina -->
        <div class="form-group">
          <label for="clienteNome">Nome do cliente (r칩tulo da piscina)</label>
          <input id="clienteNome" type="text" />
        </div>

        <div class="form-group">
          <label for="endereco">Endere칞o da piscina</label>
          <input id="endereco" type="text" />
        </div>

        <div class="form-group">
          <label for="volume">Volume (em litros)</label>
          <input id="volume" type="number" />
        </div>

        <div class="form-group">
          <label for="proximaVisita">Pr칩xima visita</label>
          <input id="proximaVisita" type="date" />
        </div>

        <!-- Bot칫es -->
        <button id="btnExportarClientes" type="button">Exportar clientes (CSV)</button>
        <button id="btnSalvarPiscina" type="submit">Salvar piscina</button>

        <p id="msgPiscina" class="muted"></p>
      </form>

      <label>Adicionar outra visita</label>
<input type="date" id="novaVisitaExtra">
<button type="button" id="btnAddVisita">Adicionar</button>

<ul id="listaVisitas"></ul>

      <input
  type="text"
  id="buscaCliente"
  placeholder="游댌 Buscar cliente..."
  style="width:100%; padding:8px; margin-bottom:10px;"
/>

      <!-- Lista de piscinas (para esse formul치rio) -->
      <ul id="listaPiscinas" class="piscinas-list"></ul>
      <p id="semPiscinas" class="muted" style="display:none;">Nenhuma piscina cadastrada.</p>
    </section>

    <!-- CARD 3: GERENCIAR PISCINAS (HIST칍RICO + EDI칂츾O R츼PIDA + CSV VISITAS) -->
    <section class="card" style="margin-top: 20px;">
      <h2>Gerenciar Piscinas</h2>

      <div style="display: flex; gap: 20px; flex-wrap: wrap;">

        <section class="card">
  <h2>Tarefas do dia (gerar manualmente)</h2>
  <p class="muted">
    Gera tarefas de hoje para todos os funcion치rios, com base nas piscinas cadastradas.
  </p>

  <button id="btnGerarTarefasHoje" type="button">
    Gerar tarefas de hoje
  </button>

  <p id="msgTarefasAdm" class="muted"></p>
</section>

<section class="card">
  <h2>Funcion치rio faltou hoje?</h2>
  <p class="muted">
    Use essa op칞칚o quando um funcion치rio n칚o for trabalhar.
    As tarefas pendentes de hoje ser칚o passadas para outro funcion치rio.
  </p>

  <div class="form-group">
    <label for="funcFaltou">Funcion치rio que faltou</label>
    <select id="funcFaltou">
      <option value="">Selecione...</option>
    </select>
  </div>

  <div class="form-group">
    <label for="funcSubstituto">Enviar tarefas para</label>
    <select id="funcSubstituto">
      <option value="">Selecione...</option>
    </select>
  </div>

  <button id="btnRepassarTarefasHoje" type="button">
    Repassar tarefas de hoje
  </button>

  <p id="msgFaltaAdm" class="muted"></p>
</section>

<section class="card" style="margin-top: 20px;">
  <h2>Falta de Funcion치rio</h2>

  <label for="funcFaltaHoje">Selecione o funcion치rio que faltou:</label>
  <select id="funcFaltaHoje">
    <option value="">Selecione...</option>
  </select>

  <button id="btnGerarRedistribuicao">Gerar redistribui칞칚o de piscinas</button>

  <div id="resultadoRedistribuicao" style="margin-top: 15px;"></div>
</section>


        <!-- LISTA DE PISCINAS PARA ADM -->
        <div style="flex: 1 1 280px;">
          <h3>Lista de piscinas</h3>
          <p id="msgPiscinasAdm" style="display:none; color:#777;">Nenhuma piscina cadastrada.</p>
          <ul id="listaPiscinasAdm" class="piscinas-list"></ul>
        </div>

        <!-- FORMUL츼RIO DE EDI칂츾O R츼PIDA -->
        <div style="flex: 1 1 280px;">
          <h3>Editar dados da piscina</h3>

          <form id="formEditarPiscina">
            <input type="hidden" id="piscina-id-adm" />

            <div>
              <label for="piscina-cliente-adm">Nome do cliente:</label>
              <input type="text" id="piscina-cliente-adm" required />
            </div>

            <div style="margin-top: 8px;">
              <label for="piscina-endereco-adm">Endere칞o:</label>
              <input type="text" id="piscina-endereco-adm" />
            </div>

            <div style="margin-top: 8px;">
              <label for="piscina-volume-adm">Volume (litros):</label>
              <input type="number" id="piscina-volume-adm" min="0" />
            </div>

            <div style="margin-top: 8px;">
              <label for="piscina-responsavel-adm">ID do respons치vel (funcion치rio):</label>
              <input type="text" id="piscina-responsavel-adm" placeholder="UID do funcion치rio" />
            </div>

            <div style="margin-top: 8px;">
              <label for="piscina-proxima-adm">Pr칩xima visita:</label>
              <input type="date" id="piscina-proxima-adm" />
            </div>

            <button type="submit" style="margin-top: 10px;">
              Salvar altera칞칫es
            </button>
          </form>
        </div>
      </div>

      <!-- HIST칍RICO DE VISITAS DA PISCINA SELECIONADA -->
      <div style="margin-top: 20px;">
        <h3>
          Hist칩rico de visitas
          <button id="btnExportarCsv" type="button" style="margin-left: 10px;">Exportar CSV</button>
        </h3>
        <div id="lista-visitas-adm">
          <p>Selecione uma piscina para ver o hist칩rico.</p>
        </div>
      </div>
    </section>

    <!-- CARD 4: EMERG칅NCIAS (ADM) -->
    <section class="card">
      <h2>
        Emerg칡ncias
        <span id="badgeEmergAdm" class="badge"></span>
      </h2>

      <p id="msgEmergAdm" class="muted">Nenhuma emerg칡ncia aberta.</p>
      <ul id="listaEmergAdm" class="piscinas-list"></ul>
    </section>

<section class="card" style="margin-top: 20px;">
  <h2>Lembretes das Piscinas</h2>
  <p class="muted">Aqui aparecem todas as instru칞칫es especiais cadastradas em cada piscina.</p>

  <ul id="listaLembretesAdm" class="piscinas-list"></ul>
  <p id="msgLembretesAdm" class="muted" style="display:none;">Nenhum lembrete cadastrado.</p>
</section>

  </main>

  <!-- Firebase SDKs (compat) -->
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.11/firebase-firestore-compat.js"></script>

  <!-- Seus arquivos JS -->
  <script src="../firebase.js"></script>
  <script src="../auth.js"></script>
  <script src="../assetsjs/dashboard-adm.js"></script>
</body>
</html>
